# Lecture3边缘提取(下)和拟合

## 边缘提取

### 1.边缘提取的方式-求导

- Prewitt 算子
  $$
  M_x=\begin{bmatrix}
  {-1}&{0}&{1}\\
  {-1}&{0}&{1}\\
  {-1}&{0}&{1}\\
  \end{bmatrix},
  M_y=\begin{bmatrix}
  {1}&{1}&{1}\\
  {0}&{0}&{0}\\
  {-1}&{-1}&{-1}\\
  \end{bmatrix}
  $$
  相比于上节课的$1 \times 2$的算子,Prewitt算子由于其范围变为了$3\times 3$,所以对单个噪声点更加稳定,不会对单个噪声点敏感。

- Sobel 算子
  $$
  M_x=\begin{bmatrix}
  {-1}&{0}&{1}\\
  {-2}&{0}&{2}\\
  {-1}&{0}&{1}\\
  \end{bmatrix},
  M_y=\begin{bmatrix}
  {1}&{2}&{1}\\
  {0}&{0}&{0}\\
  {-1}&{-2}&{-1}\\
  \end{bmatrix}
  $$
  但是噪声点还是对Prewitt算子有影响,因此可以先进行高斯滤波再进行梯度求解,故Sobel算子因此产生,以$M_x$为例,其可分解为
  $$
  M_x =\begin{bmatrix}
  {1}\\
  {2}\\
  {1}\\
  \end{bmatrix}\begin{bmatrix}
  {-1}&{0}&{1}\\
  
  \end{bmatrix}
  $$
  其中前一个为高斯核算子,后一个提取梯度

- Roberts 算子
  $$
  M_x=\begin{bmatrix}
  {0}&{1}\\
  {-1}&{0}\\
  \end{bmatrix},
  M_y=\begin{bmatrix}
  {1}&{0}\\
  {0}&{-1}\\
  \end{bmatrix}
  $$
  其中$M_x$用于提取135度的斜线,$M_y$用于提取45度的斜线

- 高斯偏导模板与高斯平滑核的区别
  - 高斯平滑核用于去噪,高斯偏导核用于提取边缘
  - 高斯平滑核模板里的权重值没有负数(由其计算公式决定),高斯偏导核里有负数
  - 高斯平滑核模板求和为1(防止平滑后出现图像衰减或像素值超出255),高斯偏导核求和为0(防止全白区域提取出边)

### 2.边缘提取-优化图像

- 提取边缘有噪声点

  通常是加一个号门限(thresholding),大于这个值才能被算作有效的边缘

- 高斯平滑导致提取的边缘较宽

  使用非极大值抑制(Non-maximum suppression)的方法,只将信号变化最剧烈的算作边

- 由于门限的存在使得部分边缘没提取到

  使用Canndy算子,其使用双门限法,思想如下:

  - 先用高门限将粗犷的边缘检测出来(由于是高门限,所以这个是边缘的置信度很高)
  - 把门限降低把响应值低的边也找出来(具体操作为对于上一步提取得到的强边缘有连接关系的才是真正的边)

  具体操作:

  1. 使用高斯偏导滤波器对x方向,y方向滤波
  2. 找到梯度强度和梯度方向
  3. 非极大值抑制(沿梯度方向去找最大,是最大则保留下来)
  4. linking and thresholding(hysteresis)
     - 定义两个门限: low and high
     - 使用高门限获取强边缘,使用低门限去连接

## 拟合

使用边缘提取可以得到边缘,但是我们并不能使用数学去描述这个边缘,因此出现了拟合。

拟合的难点:

- 噪声(可能会有很多噪声的点)
- 外点(Extraaneous data),例如一些点也是边缘,但是不是我们想要提取的边缘
- missing data (比如说线断了)

overview:

- 最小二乘法
- 有很多噪声点(robust fitting:RANSAC)
- 有许多线/外点(Voting methods: RANSAC,Hough transform)
- 不是明确有线的(Snake,蛇形方法)

### 1.最小二乘法

最小二乘要求所有点都是有效点

其能量函数/损失函数:
$$
E= \sum_{i=1}^n(y_i -mx_i -b)^2
$$
将其表达成矩阵形式能够得到我们熟知的最小二乘法的解析解$B= (X^TX)^{-1}X^TY$。如果解析解求不出来,可以使用最小二乘拟合求其近似解。

问题:该公式无法提取垂直的直线,也就是说其对于选择没有效果(旋转成垂直线)

解决问题:全最小二乘

与最小二乘的区别,最小二乘以点的竖直方向的距离作为损失,全最小二乘是以点到直线的距离作为损失。





